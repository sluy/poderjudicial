"use strict";(self["webpackChunkpoderjudicial"]=self["webpackChunkpoderjudicial"]||[]).push([[811],{9007:(e,a,t)=>{t.d(a,{LP:()=>r,nJ:()=>u,GJ:()=>c,IU:()=>s,xJ:()=>d,uf:()=>p});var l=t(5474),i=t(1959);t(6395);let o=(0,i.iH)(null);(0,i.iH)(!1);function r(){return u()?null:o.value.access_token}function n(){return o.value.userdata}function u(){return!o.value}function c(){return!u()&&(1===n().admin||!0===n().admin)}async function s(e,a,t){try{await l.api.post("auth/signup",{name:e,email:a,password:t});return!0}catch(i){return i.response&&401===i.response.status?"Error":"Internal error."}}async function d(e,a){console.log("iniciando sesión... plop",e,a);try{let t=await l.api.post("auth/login",{email:e,password:a});o.value=t.data}catch(t){return t.response&&401===t.response.status?"Invalid credentials":"Internal error."}}async function p(){if(!u())try{await l.api.get("auth/logout",{headers:{Authorization:"Bearer "+r()}})}catch(e){}return o=(0,i.iH)(null),!0}},2811:(e,a,t)=>{t.r(a),t.d(a,{default:()=>O});var l=t(3673),i=t(2323),o=t(8880);const r={class:"text-right q-pa-md"},n={class:"q-pa-md row items-start q-gutter-md"},u={class:"text-h6"},c={class:"text-subtitle text-italic"},s={class:"text-subtitle2 text-green"},d=(0,l.Uk)("ver más"),p={class:"q-pa-md text-center"},h={class:"text-h6"},m=(0,l.Uk)(" Usuario: "),v=(0,l._)("br",null,null,-1),w=(0,l.Uk)(" Fecha de creación: "),g=(0,l._)("br",null,null,-1),_=(0,l.Uk)(" Precio total (simple): "),f=(0,l._)("br",null,null,-1),y=(0,l.Uk)(" Impuesto total: "),b=(0,l._)("br",null,null,-1),z=(0,l.Uk)(" Precio final: "),Z=(0,l._)("br",null,null,-1),k=(0,l._)("hr",null,null,-1),P={class:"text-h6"},x=(0,l._)("br",null,null,-1),W=(0,l._)("br",null,null,-1),q=(0,l._)("br",null,null,-1);function A(e,a,t,A,C,D){const M=(0,l.up)("q-btn"),L=(0,l.up)("q-card-section"),U=(0,l.up)("q-separator"),H=(0,l.up)("q-card-actions"),I=(0,l.up)("q-card"),Q=(0,l.up)("q-dialog"),j=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",r,[(0,l.Wm)(M,{color:"primary",onClick:a[0]||(a[0]=a=>e.makeAll()),label:"Recargar facturas"})]),(0,l.wy)((0,l._)("div",n,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.invoices,(a=>((0,l.wg)(),(0,l.j4)(I,{class:"my-card",key:a.id},{default:(0,l.w5)((()=>[(0,l.Wm)(L,null,{default:(0,l.w5)((()=>[(0,l._)("div",u,"Factura #"+(0,i.zw)(a.id),1),(0,l._)("div",c,"Comprado por "+(0,i.zw)(a.user.name),1),(0,l._)("div",s,(0,i.zw)(a.total_price)+" $",1)])),_:2},1024),(0,l.Wm)(U),(0,l.Wm)(H,{vertical:""},{default:(0,l.w5)((()=>[(0,l.Wm)(M,{flat:"",onClick:t=>e.showInvoice(a)},{default:(0,l.w5)((()=>[d])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))],512),[[o.F8,e.invoices.length>0]]),(0,l.wy)((0,l._)("div",p,"No hay facturas realizadas",512),[[o.F8,e.invoices.length<1]]),(0,l.Wm)(Q,{modelValue:e.invoiceDialog,"onUpdate:modelValue":a[1]||(a[1]=a=>e.invoiceDialog=a),"transition-show":"rotate","transition-hide":"rotate"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(L,null,{default:(0,l.w5)((()=>[(0,l._)("div",h,"Factura #"+(0,i.zw)(e.invoiceModel.id),1)])),_:1}),(0,l.Wm)(L,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l._)("p",null,[m,(0,l._)("b",null,(0,i.zw)(e.invoiceModel.user.name)+" ("+(0,i.zw)(e.invoiceModel.user.email)+")",1),v,w,(0,l._)("b",null,(0,i.zw)(e.invoiceModel.created_at),1),g,_,(0,l._)("b",null,(0,i.zw)(e.invoiceModel.single_price),1),f,y,(0,l._)("b",null,(0,i.zw)(e.invoiceModel.total_tax),1),b,z,(0,l._)("b",null,(0,i.zw)(e.invoiceModel.total_price),1),Z]),k,(0,l._)("div",P,"Productos ("+(0,i.zw)(e.invoiceModel.boughts.length)+")",1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.invoiceModel.boughts,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.id},[(0,l._)("b",null,(0,i.zw)(e.product.name),1),x,(0,l._)("i",null,"Comprado el "+(0,i.zw)(e.created_at),1),W,(0,l.Uk)(" Precio: "+(0,i.zw)(e.product.price)+" (impuesto del "+(0,i.zw)(e.product.tax)+" %)",1),q])))),128))])),_:1}),(0,l.Wm)(H,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(M,{flat:"",label:"Decline",color:"primary"},null,512),[[j]]),(0,l.wy)((0,l.Wm)(M,{flat:"",label:"Accept",color:"primary"},null,512),[[j]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var C=t(1959),D=t(9007),M=t(5474),L=t(6249),U=t(6417);const H=(0,l.aZ)({name:"Admin",setup(){return{loading:(0,C.iH)(!1),invoices:(0,C.iH)([]),invoiceDialog:(0,C.iH)(!1),invoiceModel:(0,C.iH)(null),async makeAll(){if(L.Z.show(),!(0,D.LP)())return this.$router.push({name:"login"});try{const e=await M.api.post("invoices",{headers:{Authorization:"Bearer "+(0,D.LP)()}});if(!("object"!==typeof e.data||null===e.data||e.data.count<1))return U.Z.create({color:"positive",message:"Se han registrado "+e.data.count+" factura(s)."}),this.load();U.Z.create({message:"No se encontraron productos por facturar"})}catch(e){}L.Z.hide()},async load(){if(console.log("cargandulo plus ultra"),L.Z.show(),!(0,D.LP)())return this.$router.push({name:"login"});try{console.log((0,D.LP)());const e=await M.api.get("invoices",{headers:{Authorization:"Bearer "+(0,D.LP)()}});Array.isArray(e.data)&&(this.invoices=e.data)}catch(e){U.Z.create({color:"negative",message:"Ocurrió un error al mostrar la factura."})}L.Z.hide()},hideInvoice(){this.invoiceDialog=!1},async showInvoice(e){if(L.Z.show(),!(0,D.LP)())return this.$router.push({name:"login"});try{console.log((0,D.LP)());const a=await M.api.get("invoices/"+e.id,{headers:{Authorization:"Bearer "+(0,D.LP)()}});if("object"===typeof a.data&&null!==a.data)return this.invoiceModel=a.data,console.log(a.data),L.Z.hide(),void(this.invoiceDialog=!0)}catch(a){}U.Z.create({color:"negative",message:"Ocurrió un error al mostrar la factura."}),L.Z.hide()}}},mounted(){if(!(0,D.LP)())return this.$router.push({name:"login"});this.load()}});var I=t(4260),Q=t(6114),j=t(151),B=t(5589),F=t(5869),$=t(9367),J=t(3379),S=t(677),V=t(7518),K=t.n(V);const N=(0,I.Z)(H,[["render",A]]),O=N;K()(H,"components",{QBtn:Q.Z,QCard:j.Z,QCardSection:B.Z,QSeparator:F.Z,QCardActions:$.Z,QDialog:J.Z}),K()(H,"directives",{ClosePopup:S.Z})}}]);